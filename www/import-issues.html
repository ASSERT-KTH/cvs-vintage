<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/1999/REC-html401-19991224/loose.dtd">
<html>
<head>
	<title>Importing issue data</title>
</head>
<body bgcolor="#ffffff">

<h3>Importing issue data</h3>
<h5>$Id: import-issues.html,v 1.2 2003/01/23 18:06:00 jon Exp $</h5>

<p>
Scarab has the ability to export XML issues and then import them back
in. For now, there is a lot of pre-requirements in order for this to
happen successfully (see below). We cannot stress strongly enough that
you backup your database before you do this import as the code is in its
early early alpha stages. One thing that is known to not work entirely
yet is the import of the dependency information. I have also not done a
lot of testing of the update-same-db import-type, just the
create-same-db import-type.
</p>

<p>
There are three ways that the import can happen and this is defined by the
import-type element in the XML file:
</p>

<p>
  <strong>&lt;import-type&gt;create-same-db&lt;/import-type&gt;</strong> - 
  This means that when doing an import, all issues being imported will be 
  considered new issues, any pre-existing data will be ignored and all data
  in the XML file will be imported as new data. Right now, this is the same
  behavior as create-different-db.
</p>
<p>
  <strong>&lt;import-type&gt;create-different-db&lt;/import-type&gt;</strong> - 
  This means that when doing an import, all issues being imported will be 
  considered new issues, any pre-existing data will be ignored and all data
  in the XML file will be imported as new data. Right now, this is the same
  behavior as create-same-db.
</p>
<p>
  <strong>&lt;import-type&gt;update-same-db&lt;/import-type&gt;</strong> - 
  This means that the system will try to find existing data in the database
  (such as an ActivitySet id) and will overwrite the pre-existing data
  with what is in the XML file. If it can't find the data, it will create
  new data.
</p>

<p>
The current pre-requirements for a successful import is that all of the
modules, usernames, issue/artifact types, attributes, attribute options
referenced in the XML file must exist in the system. If they cannot be
found, then exceptions will be thrown and you must start over with a
backup of the data in your database. I plan on having a validation phase
which checks to make sure the data exists in the database before doing
the import, but for now, we just want to make sure that an import works
correctly before doing the validation.
</p>

<p>
To perform the import, one needs to setup some properties and then
execute the scarab/build/import.xml file. The properties can be defined
in a ~/build.properties file (or ~/scarab.build.properties,
scarab/build.properties, etc. Look at the top of the import.xml file
for the various locations which can be used.)
</p>

<p>
The important properties which can be defined are:
</p>

<ul>
    <li><strong>scarab.import.issues.xml</strong> - The relative or absolute path to the file 
    which is going to be used to import the issues. Default: ../src/dtd/scarab-issues-export.xml</li>
    <li><strong>scarab.import.config.file</strong> - The path to the xml import configuration
    file which defines the log4j settings and other variables. Default:
    /WEB-INF/conf/xmlimport.properties</li>
    <li><strong>scarab.import.trprops.file</strong> - The path to the TurbineResources.properties
    file which defines things like the connection to the database. Default: 
    /WEB-INF/conf/TurbineResources.properties</li>
</ul>

<p>
The best thing to do in the early stages of this development phase is
to cd into the build directory and first make sure that Scarab is built (type: <strong>ant</strong>). 
Then, type the following: <strong>ant -f import.xml</strong>
</p>

<p>
You should then see the debugging output sent to the screen. If you see an 
exception, please make sure to 
<a href="mailto:jon@latchkey.com?subject=xml import problems">send it to me</a> 
so that I can look into fixing it.
</p>

</body>
</html>
