<html>
<head>
<title>Scarab - Postgresql</title>
</head>

<body bgcolor="#ffffff">

<h2>Scarab - Postgresql</h2>
<h4>$Id: postgresql.html,v 1.5 2003/01/31 23:02:49 jon Exp $</h4>

<p>
Scarab has been developed with database independence in mind, however
our primary goal has been to make Scarab work with MySQL. Therefore, our
support for other RDBM's is largely untested. We are relying on the user
community in order to help us test and develop further support for other
databases. This document outlines the steps that we think is required
to get Scarab working with Postgresql. <a
href="mailto:dev@scarab.tigris.org">Community feedback</a> on this
document will help improve things for others.
</p>

<p>
<strong>NOTE: Scarab requires Postgresql version 7.2.1 and higher.</strong>
</p>

<p>
NOTE: If you are seeing this exception:
</p>

<pre>
  java.lang.StringIndexOutOfBoundsException: String index out of range: 23
	at java.lang.String.charAt(String.java:460)
	at org.postgresql.jdbc2.ResultSet.toTimestamp(ResultSet.java:1653)
	at org.postgresql.jdbc2.ResultSet.getTimestamp(ResultSet.java:398)
</pre>

<p>
It is because you are using an older JDBC.jar with a newer version of Postgresql. 
Please upgrade your .jar file by copying a newer Postgresql
.jar file as scarab/lib/postgresql-7.X.jar and removing the one in 
scarab/target/webapps/scarab/WEB-INF/lib/postgres*.jar Once you have done that,
you just need to rebuild.
</p>

<hr noshade="true" size="1" />

<p>
In order to get Torque to generate the right Scarab .sql files for
Postgresql and to allow Scarab to connect to Postgres, please try the
following directions:
</p>

<ol>
<li>
    Create a scarab/build/build.properties file. There are instructions
    in the SCARAB/README.txt file which detail why you want to do this.
</li>
<li>
    In the build.properties file, fill out the following properties with
    the right information pertaining to Postgresql (see below for
    examples). Then, remove the target directory and rebuild.
</li>
<li>
    One should also follow the directions for setting up Postgresql to
    accept <a
    href="http://www.ca.postgresql.org/users-lounge/docs/7.2/postgres/jdbc.html#JDBC-PREPARE">TCP/IP connections from localhost</a>.

<p><code>
scarab.database.name=scarab<br />
scarab.database.port=5432<br />
scarab.database.host=localhost<br />
scarab.database.url=jdbc:postgresql://${scarab.database.host}:${scarab.database.port}/${scarab.database.name}<br />
scarab.database.admin.url=jdbc:postgresql://${scarab.database.host}:${scarab.database.port}/<br />
scarab.database.type=postgresql<br />
scarab.database.jdbc.driver=org.postgresql.Driver<br />
scarab.database.username=[INSERT_USERNAME_HERE]<br />
scarab.database.password=<br />
</code></p>
</li>

<li>
    Use the scarab/src/sql/create-db.sh script to create and populate the database. 
    For example:
    
    <p><code>
    cd scarab/src/sql
    ./create-db.sh [arguments]
    </code></p>
    <p>
    To get a list of arguments that the create-db.sh script accepts, one can just execute
    <code>./create-db.sh --help</code>
    </p>
</li>
</ol>


</body>
</html>
