<?xml version="1.0" encoding="UTF-8"?>
<!--
 - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
 - The contents of this file are subject to the LGPL Licence 
 -
 - <a href="Guillaume.Riviere@inrialpes.fr">Guillaume RIVIERE</a>
 -
 - Compilation directive for jeremie rmic 
 - this task did not use the rmic ant task because this 
 - task is not supporded with the jeremie rmic 
 - and so we use a java task ...
 -
 -->

<project name="rmic_jonathan" default="compile.all" basedir=".">

  <!-- Building of a path which contains carol jars for tests compilation-->
  <path id="jonathan.classpath">
    <fileset dir="${carol.dist}/lib">
      <include name="**/*.jar"/>
    </fileset>  
    <fileset dir="${test.externals}">
      <include name="**/*.jar"/>
    </fileset>    
    <fileset dir="${test.ext}">
      <include name="jonathan.xml"/>
    </fileset>
    <pathelement location="${test.build}/classes"/>
    
  </path>

  <property name="compiler.jeremie" value="org.objectweb.jeremie.tools.jrmic.JRMICompiler" />

  <target name="compile.all"> 
    <antcall target="compile.jeremie"/>
  </target>


  <!-- Compile Remote Interface Stub/Skel target for Jeremie-->
  <target name="compile.jeremie">
    <mkdir dir="${test.build.stub}/jeremie"/>
    <java classname="${compiler.jeremie}" fork="true" failonerror="true">
      <arg value="-opt"/>
      <arg value="-owext"/>
      <arg value="-d"/>
      <arg path="${test.build.stub}/jeremie"/>
      <arg value="org.objectweb.carol.jtests.conform.basic.server.BasicObject"/>
      <arg value="org.objectweb.carol.jtests.conform.basic.server.BasicMultiObject"/>
      <classpath refid="jonathan.classpath"/>
    </java>
    <jar destfile="${test.dist.lib}/jeremie_stub.jar" basedir="${test.build.stub}/jeremie" />
  </target>   
</project>
