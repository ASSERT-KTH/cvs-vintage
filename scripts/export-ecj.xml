<?xml version="1.0" encoding="UTF-8"?>

<!-- build script to create a batch compiler from org.eclipse.jdt.core -->
<project name="Eclipse Batch Compiler" default="export" basedir="..">
	<target name="init">
		<tstamp/>
		<property name="bin" value="bin" />
		<property name="dest" value="../../ecj-export" />
	</target>

	<target name="export" depends="init">
		<echo message="TARGET: ${dest}" />
		<mkdir dir="${dest}" />

		<echo message="UPDATE ecj.jar" />
		<zip zipfile="${dest}/ecj.jar">
			<fileset dir="scripts">
			  <include name="META-INF/**" />
			  <include name="about.html" />
	        </fileset>
	        <fileset dir="${bin}" includes="org/eclipse/jdt/internal/compiler/**,org/eclipse/jdt/core/compiler/**">
	        	<exclude name="org/eclipse/jdt/core/compiler/CompilationParticipant*.class"/>
	        	<exclude name="org/eclipse/jdt/core/compiler/BuildContext.class"/>
	        	<exclude name="org/eclipse/jdt/core/compiler/IScanner.class"/>
	        	<exclude name="org/eclipse/jdt/core/compiler/ITerminalSymbols*.class"/>
	        	<exclude name="org/eclipse/jdt/core/compiler/ReconcileContext*.class"/>
	        	<exclude name="org/eclipse/jdt/internal/compiler/DocumentElementParser*.class"/>
	        	<exclude name="org/eclipse/jdt/internal/compiler/IDocumentElementRequestor.class"/>
	        	<exclude name="org/eclipse/jdt/internal/compiler/ISourceElementRequestor.class"/>
	        	<exclude name="org/eclipse/jdt/internal/compiler/SourceElementParser*.class"/>
	        	<exclude name="org/eclipse/jdt/internal/compiler/SourceElementRequestorAdapter*.class"/>
	        	<exclude name="org/eclipse/jdt/internal/compiler/SourceJavadocParser*.class"/>
	        	<exclude name="org/eclipse/jdt/internal/compiler/parser/SourceTypeConverter*.class"/>
        	</fileset>
		</zip>
		<echo message="UPDATE ecjsrc.zip" />
		<zip zipfile="${dest}/ecjsrc.zip">
		    <zipfileset dir="batch" />
		    <zipfileset dir="compiler" />
			<zipfileset dir="scripts">
			  <include name="about.html" />
			</zipfileset>			
  		</zip>		
	
	</target>
</project>
