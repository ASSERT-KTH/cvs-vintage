<?xml version="1.0" encoding="UTF-8"?>

<!-- build script to create a plugin from org.eclipse.jdt.core -->
<project name="org.eclipse.jdt.core" default="export plug-in [_2.1.0]" basedir="..">

<target name="zz_init">
	<tstamp/>
	<property name="export-dir" value="../../plugin-export" />
</target>

<target name="export plug-in [_2.1.0]" depends="zz_init">
	<antcall target="zz_internal_export">
		<param name="dest" value="${export-dir}/org.eclipse.jdt.core_2.1.0"/>
	</antcall>
</target>

<target name="export plug-in [_2.1.0] (directory structure)" depends="zz_init">
	<antcall target="zz_internal_export_structure">
		<param name="bin_dest" value="${export-dir}/eclipse/plugins/org.eclipse.jdt.core_2.1.0"/>
		<param name="src_dest" value="${export-dir}/eclipse/plugins/org.eclipse.jdt.source_2.1.0/src/org.eclipse.jdt.core_2.1.0"/>
	</antcall>
</target>

<target name="export plug-in [_2.0.1]" depends="zz_init">
	<antcall target="zz_internal_export">
		<param name="dest" value="${export-dir}/org.eclipse.jdt.core_2.0.1"/>
	</antcall>
</target>

<target name="export plug-in [_2.0.0]" depends="zz_init">
	<antcall target="zz_internal_export">
		<param name="dest" value="${export-dir}/org.eclipse.jdt.core_2.0.0"/>
	</antcall>
</target>

<target name="export plug-in [_1.9.0]" depends="zz_init">
	<antcall target="zz_internal_export">
		<param name="dest" value="${export-dir}/org.eclipse.jdt.core_1.9.0"/>
	</antcall>
</target>

<target name="export plug-in [no version]" depends="zz_init">
	<antcall target="zz_internal_export">
		<param name="dest" value="${export-dir}/org.eclipse.jdt.core"/>
	</antcall>
</target>

<target name="zz_internal_export">

	<tstamp/>

	<echo message="TARGET: ${export-dir}" />
	<mkdir dir="${export-dir}" />
	<delete dir="${dest}" />
	<mkdir dir="${dest}" />

	<echo message="UPDATE jdtcore.jar" />
	<jar 
		jarfile="${dest}/jdtcore.jar"
		basedir="bin" 
		excludes="**/JDTCompilerAdapter.class"/>
		
	<echo message="UPDATE jdtCompilerAdapter.jar" />
	<jar 
		jarfile="${dest}/jdtCompilerAdapter.jar"
		basedir="bin" 
		includes="**/JDTCompilerAdapter.class"/>

	<echo message="UPDATE plugin.xml" />
	<copy file="plugin.xml" todir="${dest}" />
	<echo message="UPDATE plugin.properties" />
	<copy file="plugin.properties" todir="${dest}" />

	<echo message="UPDATE .options" />
	<copy file=".options" todir="${dest}" />

	<echo message="UPDATE about.html" />
	<copy file="about.html" todir="${dest}" />

	<echo message="UPDATE jdtcoresrc.zip" />
	<zip zipfile="${dest}/jdtcoresrc.zip">
	    <zipfileset dir="batch" />
	    <zipfileset dir="codeassist" />
	    <zipfileset dir="compiler" />
	    <zipfileset dir="dom" />
	    <zipfileset dir="eval" />
	    <zipfileset dir="formatter" />
	    <zipfileset dir="model" />
	    <zipfileset dir="search" />
	</zip>		
	<echo message="UPDATE jdtCompilerAdaptersrc.zip" />
	<zip zipfile="${dest}/jdtCompilerAdaptersrc.zip">
		<zipfileset dir="antadapter" />
	</zip>	    
</target>

<target name="zz_internal_export_structure">

	<tstamp/>

	<echo message="TARGET: ${export-dir}" />
	<mkdir dir="${export-dir}" />
	<delete dir="${bin_dest}" />
	<delete dir="${src_dest}" />
	<mkdir dir="${bin_dest}" />
	<mkdir dir="${src_dest}" />

	<echo message="UPDATE jdtcore.jar" />
	<jar 
		jarfile="${bin_dest}/jdtcore.jar"
		basedir="bin" 
		excludes="**/JDTCompilerAdapter.class"/>
		
	<echo message="UPDATE jdtCompilerAdapter.jar" />
	<jar 
		jarfile="${bin_dest}/jdtCompilerAdapter.jar"
		basedir="bin" 
		includes="**/JDTCompilerAdapter.class"/>

	<echo message="UPDATE plugin.xml" />
	<copy file="plugin.xml" todir="${bin_dest}" />
	<echo message="UPDATE plugin.properties" />
	<copy file="plugin.properties" todir="${bin_dest}" />

	<echo message="UPDATE .options" />
	<copy file=".options" todir="${bin_dest}" />

	<echo message="UPDATE about.html" />
	<copy file="about.html" todir="${bin_dest}" />

	<echo message="UPDATE jdtcoresrc.zip" />
	<zip zipfile="${src_dest}/jdtcoresrc.zip">
	    <zipfileset dir="antadapter" />
	    <zipfileset dir="batch" />
	    <zipfileset dir="codeassist" />
	    <zipfileset dir="compiler" />
	    <zipfileset dir="dom" />
	    <zipfileset dir="eval" />
	    <zipfileset dir="formatter" />
	    <zipfileset dir="model" />
	    <zipfileset dir="search" />
	</zip>		
</target>

</project>
