
<!-- Export executable version of batch compiler, using GCJ -->
<!--
        gcc-target    - the gcc target name to use (for example, i686-pc-mingw32)
        binaryname    - the name to give to the final binary
-->
<?xml version="1.0" encoding="UTF-8"?>
<project name="export-executable" default="build_executable"/>

    <target name="build_executable">
        <echo message='compiling resources   -> .o'/>
   		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/batch/messages.properties org/eclipse/jdt/internal/compiler/batch/messages.properties -c -o org/eclipse/jdt/internal/compiler/batch/messages.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser1.rsc org/eclipse/jdt/internal/compiler/parser/parser1.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser1.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser10.rsc org/eclipse/jdt/internal/compiler/parser/parser10.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser10.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser11.rsc org/eclipse/jdt/internal/compiler/parser/parser11.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser11.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser12.rsc org/eclipse/jdt/internal/compiler/parser/parser12.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser12.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser13.rsc org/eclipse/jdt/internal/compiler/parser/parser13.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser13.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser14.rsc org/eclipse/jdt/internal/compiler/parser/parser14.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser14.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser15.rsc org/eclipse/jdt/internal/compiler/parser/parser15.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser15.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser16.rsc org/eclipse/jdt/internal/compiler/parser/parser16.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser16.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser17.rsc org/eclipse/jdt/internal/compiler/parser/parser17.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser17.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser18.rsc org/eclipse/jdt/internal/compiler/parser/parser18.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser18.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser19.rsc org/eclipse/jdt/internal/compiler/parser/parser19.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser19.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser2.rsc org/eclipse/jdt/internal/compiler/parser/parser2.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser2.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser20.rsc org/eclipse/jdt/internal/compiler/parser/parser20.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser20.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser3.rsc org/eclipse/jdt/internal/compiler/parser/parser3.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser3.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser4.rsc org/eclipse/jdt/internal/compiler/parser/parser4.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser4.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser5.rsc org/eclipse/jdt/internal/compiler/parser/parser5.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser5.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser6.rsc org/eclipse/jdt/internal/compiler/parser/parser6.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser6.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser7.rsc org/eclipse/jdt/internal/compiler/parser/parser7.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser7.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser8.rsc org/eclipse/jdt/internal/compiler/parser/parser8.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser8.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/parser/parser9.rsc org/eclipse/jdt/internal/compiler/parser/parser9.rsc -c -o org/eclipse/jdt/internal/compiler/parser/parser9.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/problem/messages.properties org/eclipse/jdt/internal/compiler/problem/messages.properties -c -o org/eclipse/jdt/internal/compiler/problem/messages.o"/>
  		</exec>
  		<exec dir="${work}" executable="${gcc-path}/bin/gcj.exe" os="Windows 2000">
  		  <arg line="--resource org/eclipse/jdt/internal/compiler/util/messages.properties org/eclipse/jdt/internal/compiler/util/messages.properties -c -o org/eclipse/jdt/internal/compiler/util/messages.o"/>
  		</exec>
  		  			        
	    <echo message='compiling sources      -> .o'/>
        <apply failonerror='true' executable='${gcc-path}/bin/gcj.exe' dest='${work}' parallel='false' output="${build_output}">
        	<arg value="--verbose"/>
            <arg value='--classpath=${work}'/>
            <arg value='-O2'/>
            <arg value='-c'/>
            <arg value='-fassume-compiled'/>
            <srcfile/>
            <arg value='-o'/>
            <targetfile/>
            <fileset dir='${work}' includes='**/*.java'/>
            <mapper type='glob' from='*.java' to='*.o'/>
        </apply>
        
        <echo message='linking .o -> ${binaryname}'/>
        <apply failonerror='true' executable='${gcc-path}/bin/gcj.exe' parallel='true' output="${build_output}">
        	<arg value="--verbose"/>
            <arg line ='-o ${dest}${binaryname}.exe'/>
            <arg value='-fassume-compiled'/>
            <arg line='--main=org.eclipse.jdt.internal.compiler.batch.Main'/>
            <fileset dir='${work}' includes='**/*.o'/>
       </apply>
    </target>
</project>
