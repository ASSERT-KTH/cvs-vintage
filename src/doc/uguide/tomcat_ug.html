
<html>
  <head>
    <!-- $Id: tomcat_ug.html,v 1.2 2000/03/16 20:43:22 costin Exp $ -->
    <!-- Copyright 1999, Apache Software Foundation -->
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <link rel="stylesheet" href=style.css>
    <title>Tomcat - A Minimalistic Users Guid</title>
    <!-- Changed by: Costin Manolache, 16-Mar-2000 -->
  </head>
  <body link="#0000ff" vlink="#800080">
    <!-- Banner element, all hail the Project! -->
    <table border="0">
      <tr>
	<td>
	  <p>
	    <a href="http://jakarta.apache.org/index.html"><img src=images/banner.gif width="350"
	      height="100" alt="The Jakarta Project" border="0"></a>
	  </p>
	</td>
      </tr>
    </table>
    
    <H1>Tomcat - A Minimal User's Guide</H1>
    <p>This document provides some basic information about Tomcat. Some of
      the issues covered here are:
      
    <ol>
      <li>The installation of the Tomcat binary version. </li>
      <li>Cover the main issues related to the scripts used by tomcat. </li>
      <li>Cover the main issues related to server.xml, tomcat's main
	configuration file. </li>
      <li>Explain how to set up Tomcat to work with native web server. </li>
      <li>Explain how to deploy tomcat on a real web site.</li>
    </ol>
    
    Hopefully this should be enough for you to get started with tomcat. If
    something is missing you should (in this order):</p>
    <ol>
      <li>Search the Tomcat <a href="http://jakarta.apache.org/jyve-faq/Turbine/screen/MainMenu/faq_id/12/project_id/2/screen/DisplayTopics/action/SetAll?JServSessionIdjyve-faq=d3gxal9wqz"> faq </a> </li>
      
      <li>Search the Tomcat list <a href="http://www.metronet.com/~wjm/tomcat/"> archive </a>. </li>
      <li>Post a question to the tomcat <a href="http://jakarta.apache.org/getinvolved/mail.html">
	  mailing lists </a>.
    </ol>    
    And when you find an answer to your question please add it to the
    faq/this document.
  </p>
    
    <p>
      If you have any comments or suggestions about this document don't
      hesitate to send them to the tomcat 
      <a href="http://jakarta.apache.org/getinvolved/mail.html">mailing lists </a>.
    </p>
    
    <h2>Getting Started</h2>
    <p>  Tomcat is a servlet container with a JSP environment.
      A servlet container is a runtime shell that manages and invokes servlets on behalf of
      users.</p>
    
    <p>You can roughly partition servlet containers into:</p>
    <ol>
      <li><strong><u>Stand-alone servlet containers</u></strong><br>
	These are an integral part of the web server. This
	is the case when you are using a Java-based web server, for example the
	servlet container that is part of the JavaWebServer. Stand-alone is the 
	default mode used by Tomcat.<br>
	Most web servers, however, are not Java-based, what leads us to the next 
	two container types.
      <li><strong><u>In-process servlet containers</u></strong><br> 
	The servlet container is a combination of a web
	server plugin and a Java container implementation. The web server plugin opens
	a JVM inside the web server's address space and lets the Java container run in
	it. If a certain request should execute a Servlet, the plugin takes control
	over the request and passes it (using JNI) to the Java container. An
	in-process container is suitable for multi-threaded single-process servers and
	provides good performance but is limited in scalability.
      <li><strong><u>Out-of-process servlet containers</u></strong><br>
	The servlet container is a combination of a
	web server plugin and a Java container implementation that runs
	in a JVM outside the web server. The web server plugin and the Java
	container JVM communicate using some IPC mechanism (usually TCP/IP sockets).
	If a certain request should execute a Servlet, the plugin takes
	control over the request and passes it (using the IPCs) to the Java container.
	The response time of an out-of-process engine is not as good as
	in the in-process one but the former is better in any other
	measurable way (scalability, stability, etc.).
      </li>
    </ol>

    <p>Tomcat can be used as either a stand-alone container
      (mainly for development and debugging) or an add-on to an existing web server
      (currently Apache, IIS and Netscape servers are supported). This means that
      whenever you are deploying Tomcat you will have to decide how to use it, and
      if you select options 2 or 3 you will also need to install a web server
      adapter.</p>

    <h2>What is the Difference Between Tomcat and Jserv? Isn't Tomcat==Jserv?</h2>
    <p>   This is a common misunderstanding. Jserv is a Servlet API
      2.0-compliant container that was created to be used with Apache. Tomcat is a
      complete re-write and is a Servlet API 2.2 and JSP 1.1-compliant container.
    </p>
    <p>   Tomcat uses some of the code written for Jserv,
      especially Jserv's Apache server adapter, but this is where the common part ends.
    </p>

    <h2>How Do I Install the Binary Version of Tomcat?</h2>
    
    <p>Very simple. You should:</p>
    
    <ul>
      <li>Download the zip/tar.gz/whatever file from
	<A HREF="http://jakarta.apache.org/downloads/binindex.html">
	  http://jakarta.apache.org/downloads/binindex.html</A>.
	
      <li>Unzip the file into some directory (say foo). This
	should create a new subdirectory named "tomcat".
	
      <li>Change directory to "tomcat" and set a new environment variable
	(TOMCAT_HOME) to point to the root directory of your tomcat hierarchy
	
        <ol>
	  <li>On Win32 you should type "set
	    TOMCAT_HOME=foo\tomcat"
	    
	  <li>On UNIX you should type: <BR>
	    For bash/sh "TOMCAT_HOME=foo/tomcat ; export TOMCAT_HOME"<BR>
	    For tcsh "setenv TOMCAT_HOME foo/tomcat"</li>
	  
	</ol>
      <li>Set the environment variable JAVA_HOME to point to the root
	directory of your JDK hierarchy. Add the Java interpreter to your PATH
	environment variable.
      </li>
    </ul>
    
    <p> That's it! You can now execute Tomcat and it will run as a
      stand-alone (type 1) servlet container.
    </p>
    
    <h2>Starting and Stopping Tomcat</h2>
    <p>You start and stop Tomcat using the scripts in
      the bin directory.</p>
    <P>To start Tomcat execute:</P>
    <BLOCKQUOTE style="MARGIN-RIGHT: 0px">
      <p>On UNIX: bin/startup.sh</p>
      <p>On Win32: bin\startup</p>
    </BLOCKQUOTE>
    <p>To stop Tomcat execure: </p>
    <BLOCKQUOTE style="MARGIN-RIGHT: 0px">
      <p>On UNIX: bin/shutdown.sh </p>
      <p>On Win32: bin\shutdown</p>
    </BLOCKQUOTE>
    
    <h2>The Tomcat directory structure</h2>
    <p>Assuming you unzipped /untared the tomcat binary distribution you should
      have the following directory structure:</p>
    <table border width="75%" valign="MIDDLE">
      <tr>
	<th BGCOLOR="#c0c0c0" WIDTH="25%"> Directory name</th>
	<th BGCOLOR="#c0c0c0" WIDTH="75%"> Description</th>
      </tr>
      <tr>
	<td> bin </td>
	<td> Contains startup/shutdown... scripts</td>
      </tr>
      <tr>
	<td> conf </td>
	<td> Contains various configuration files including
	  <em>server.xml</em> (Tomcat's main configuration file) and
	  <em>web.xml</em>
	  that sets
	  the default values for the various web applications deployed in Tomcat.</td>
      </tr>
      <tr>
	<td> doc </td>
	<td>Contains miscellaneous documents regarding Tomcat</td>
      </tr>
      <tr>
	<td> lib </td>
	<td> Contains various jar files that are used by Tomcat. On UNIX any
	  file in this directory is appended to Tomcat's classpath.</td>
      </tr>
      <tr>
	<td> logs </td>
	<td> This is where Tomcat places its log files.</td>
      </tr>
      <tr>
	<td> src </td>
	<td> The servlet APIs source files.&nbsp;Don't get excited,
	  though -&nbsp;these are only the empty interfaces and abstract
	  classes that should be implemented by any servlet
	  container.</td>
      </tr>
      <tr>
	<td> webapps </td>
	<td> Contains sample web applications. </td>
      </tr>
    </table>
    
    <p>Additionally you can (or tomcat will) create the following directories:</p>
    <table BORDER WIDTH="75%" VALIGN="MIDDLE">
      <tr>
	<td> work </td>
        <td> Automatically generated by tomcat, this is where tomcat place
	  intermediate files during its work.
	</td>
      </tr>
      <tr>
	<td> classes </td>
        <td> You can create this directory to add additional classes to the
	  classpath. Any class that you add to this directory will find its
	  place in tomcat's classpath.
	</td>
      </tr>
    </table>

    <h2>The Tomcat Scripts</h2>
    <p>Tomcat is a Java program, and if you really want that you can execute it
      from the command line after setting several environment variables. However
      setting each environment variable and following the command line parameters
      used by Tomcat is an error prone and tedious task. Instead, the Tomcat
      development team provides a few scripts to ease starting and stopping
      Tomcat</p>

    <p><B>Note: The scripts are only a convenient way to start/stop...
	You can modify them to customize the CLASSPATH, environment variables
	such as PATH and LD_LIBRARY_PATH, etc. as long as you generate a
	correct	command line for Tomcat.</B>
    </p>

    <p>What are these scripts? The following table presents the scripts that are
      most important for the common user:</p>
    <table border width="75%" valign="MIDDLE">
      <tr>
	<th BGCOLOR="#c0c0c0" WIDTH="25%"> Script name </th>
        <th BGCOLOR="#c0c0c0" WIDTH="75%"> Description </th>
      </tr>
      <tr>
	<td> tomcat </td>
        <td> The main script. Set the proper environment (including
	  CLASSPATH, TOMCAT_HOME and JAVA_HOME) and start Tomcat with the
	  proper command line parameters. </td>
      </tr>
      <tr>
	<td> startup </td>
        <td> Starts tomcat in the background. Shortcut for "tomcat start" </td>
      </tr>
      <tr>
	<td> shutdown </td>
        <td> Stops tomcat (shutting it down). Shortcut for "tomcat stop" </td>
      </tr>
    </table>

    <p>The script whose behavior is the most important for us is
      tomcat (tomcat.sh/tomcat.bat). The other entire tomcat related scripts 
      serve as a simplified single-task oriented entry point to the tomcat 
      script (set different command line parameters etc.).
      </p>

      <p>
      A closer look at tomcat.sh/tomcat.bat yield that it performs the
      following actions:</p>

    <table border =1 width="75%" valign="MIDDLE">
      <tr>
	<th BGCOLOR="#c0c0c0" WIDTH="25%"> Operating System </th>
	<th BGCOLOR="#c0c0c0" WIDTH="75%"> Actions </th>
      </tr>
      <tr>
	<td> Unix </td>
	<td>
	  <ul>
	    <li>Guessing what is TOMCAT_HOME if it is not
	      specified.
	      
	    <li>Guessing what is JAVA_HOME if it is not
	      specified.
	      
	    <li>Setting up a CLASSPATH that contains
	      
	      <ol>
		<li>The ${TOMCAT_HOME}/classes directory (if
		  available)
		  
		<li>All the contents of ${TOMCAT_HOME}/lib
		  
		<li>${JAVA_HOME}/lib/tools.jar (this jar file contains the tool
		  javac, we need javac for jsp files) </li>
	      </ol>
	    <li>Executes java with command line parameters that
	      set's up a java system environment called tomcat.home and with
	      org.apache.tomcat.startup.Tomcat as the startup class. Also pass command
	      line parameters to org.apache.tomcat.startup.Tomcat such as:
	      
	      <ol>
		<li>The operation to perform start/stop/run/etc.
		  
		<li>A path to the server.xml used by for this tomcat process. </li>
	      </ol>
	      <p>For example if your server.xml is located in /etc/server_1.xml and you
		want to start apache in the background can should provide the following command
		line: bin/tomcat.sh start -f /etc/server_1.xml</p>
	      <ul></ul>	      	      
	    </li></ul>
	</td>
      </tr>
      <tr>
	<td> Win32 </td>
	<td>
	  <ul>
	    <li>Setting up a CLASSPATH that contains
	      
	      <ol>
		<li> servlet.jar, webserver.jar, jasper.jar,
		  xml.jar from the %TOMCAT_HOME%\lib directory
		  
		<li> %TOMCAT_HOME%\classes (even if does not
		  exists)
		  
		<li> %JAVA_HOME%\lib\tools.jar (this jar file contains the tool
		  javac, we need javac for jsp files) </li>
	      </ol>
	    <li>Executes java (assuming that it in the PATH)
	      with command line parameters that set's up a java system environment
	      called tomcat.home and with org.apache.tomcat.startup.Tomcat as the
	      startup class. Also pass command line parameters to
	      org.apache.tomcat.startup.Tomcat such as:
	      
	      <ol>
		<li>The operation to perform start/stop/run/etc.

		<li>A path to the server.xml used by for this tomcat process. </li>
	      </ol>
	      <p>For example if your server.xml is located in conf\server_1.xml and you
		want to start apache in the background can should provide the following command
		line: bin\tomcat.bar start -f conf\server_1.xml</p>
	      <ul></ul>	      	      	      
	    </li></ul>
        </td>
      </tr>
    </table>

    <p>As you can see, the Win32 version of tomcat.bat pales compared to the Unix
      one. Especially it does not guess the values of TOMCAT_HOME and
      JAVA_HOME and it also doesn't take all the jar files into the classpath.</p>

    <h2> Tomcat's Configuration Files </h2>
    <p> Tomcat's configuration is based two files:
    <ol>
      <li> server.xml - Tomcat's global configuration file. </li>
      <li> web.xml - Configures the various contexts in Tomcat. </li>
    </ol>

    This section will deal with how to use these files. We are not going to cover the internals
    of web.xml, these internals are covered in depth in the Servlet APIs spec. Instead we will
    cover the content of server.xml and discuss the usage of web.xml in the context of Tomcat.
  </p>

    <h3> server.xml </h3>
    <p> server.xml is Tomcat's main configuration file. It serves two goals:
    <ol>
      <li> Providing initial configuration for the Tomcat components. </li>
      <li> Specifying structure for Tomcat, meaning, letting Tomcat
	boot and build itself by instanciating components as specified in
	server.xml.
    </ol>
    The important elements in server.xml are described in the following table:
    <table border width="75%" valign="MIDDLE">
      <tr>
	<th BGCOLOR="#c0c0c0" WIDTH="20%"> Element </th>
        <th BGCOLOR="#c0c0c0" WIDTH="80%"> Description </th>
      </tr>
      <tr>
	<td> Server </td>
        <td> This topmost element in the file server.xml file. Server 
	   defines a single Tomcat server. Generally you should not bother 
	   with it too much. A Server element can contain elements of type 
	   Logger and ContextManager. </td>
      </tr>
      <tr>
	<td> Logger </td>
        <td> This element defines a logger object. Each logger has a name to identify
	  it, as well as a path to the log file to contain the logger output and a
	  verbosityLevel (that specifies the log level).
	  Currently there are loggers for the servlets (where the ServletContext.log() goes),
	  JSP files and the  tomcat runtime. </td>
      </tr>
      <tr>
	<td> ContextManager </td>
        <td> A ContextManager specifies the configuration and structure for a set of
	  ContextInterceptors, RequestInterceptors, Contexts and their Connectors.
	  The ContextManager has a few attributes that provides it with:
	  <ol>
	    <li> Debug level used for logging debug messages. </li>
	    <li> The base location for webapps/, conf/, logs/ and all defined contexts. 
	         It is used to start tomcat from directory different from TOMCAT_HOME.
	    </li>
	    <li> The name of the working directory. </li>
	  </ol>
	</td>
      </tr>
      <tr>
	<td> ContextInterceptor & RequestInterceptor </td>
        <td> These interceptors listen for certain events that happen in the ConetexManager.
	  For example, the ContextInterceptor listens for startup and shutdown events of
	  Tomcat and the RequestInterceptor watching the various phases that 
	  user requests need to pass during its service.
	  Tomcat's administrator does need to know much about the interceptors; a developer
	  on the other hand should know that this is how "global" type of operations can be
	  implemented in Tomcat (for example security and per request logging). </td>
      </tr>
      <tr>
	<td> Connector </td>
        <td> The Connectors represents a connection to the user, either through a web
	  server or directly to the user's browser (in a stand-alone configuration).
	  The connector objects is the one responsible for the management of the Tomcat worker
	  threads and for reading/writing requests/responses from the sockets connecting to the
	  various clients.

	  The configuration of the connectors includes information such as:
	  <ol>
	    <li> The <tt>handler</tt> class. </li>
	    <li> The TCP/IP <tt>port</tt> where the handler listens.</li>
	    <li> The TCP/IP <tt>backlog</tt> for the handler server socket. </li>
	  </ol>
	  We will describe how to use this Connector configuration later in the document.
	</td>
      </tr>
      <tr>
	<td> Context </td>
        <td> Each Context represents a path in the Tomcat hierarchy where you 
	     place a web application. A Tomcat Context has the following 
	     configuration:
	  <ol>
	    <li>  The path where the context is located. This can be a full path
	      or relative to the ContextManager's home. </li>
	    <li> Debug level used for logging debug messages. </li>
	    <li> A reloadable flag. When developing a servlet it is very convenient to have Tomcat
	      reload it upon change, this let you fix bugs and have Tomcat test the new code without
	      the need to shutdown and restart. To turn on servlet reloading set the reloadable flag to
	      true. Detecting changes however, is time consuming; moreover, since the new servlets are
	      getting loaded in a new class-loader object there are cases where this class-reloading
	      trigger cast errors. To avoid these problems, you can set the reloadable flag to false;
	      this will disable the autoreload feature.</li>
	  </ol>
	</td>
      </tr>
    </table>

    </p>
    <h3> Starting tomcat from another directory </h3>
    
    <p>By default tomcat will use TOMCAT_HOME/conf/server.xml for configuration. The default 
       configuration will use TOMCAT_HOME as base for the contexts. </p>
    <p>You can change this by using "-f /path/to/server.xml" option, and a different server 
       configuration file and setting the home property of the context manger. You need to 
       set up the required files inside the home: </p>
    <ul>
      <li>A webapps/ directory ( if you create one ) - all war files will be expanded and 
	all subdirectories added as contexts.</li>
      <li>conf/ directory - you can store a special web.xml and other configuration files</li>
      <li>logs/ - all logs will go to this directory instead of the main TOMCAT_HOME/logs/</li>
      <li>work/ - work directories for the contexts.
      </li>
    </ul>

    <p>If the ContextManager.home property in server.xml is relative, it will be relative to
      the current working directory.</p>

    <h3> web.xml </h3>
    <p>
      A detailed description of web.xml and the web application structure
      (including directory structure and configuration) is available in
      chapters 9, 10 and 14 of the
      <a href="http://java.sun.com/products/servlet/">Servlet API Spec</a>
      and we are not going to write about it. </p>
    <p>
      There is however a small Tomcat related "feature" that is related to web.xml, and I do want
      to describe it... Tomcat let you define a default web.xml values for all your context by putting
      a default web.xml file in the conf directory. When constructing a new Context, Tomcat uses
      the default web.xml file as the base configuration and the application specific web.xml (that is
      the one located in the application's WEB-INF/web.xml) only overwrite these defaults.
    </p>

    <h2>Setting Tomcat to Cooperate with the Apache Web Server </h2>

    <p> Up until now we did not discuss Tomcat as a server add on, instead we considered it
      a stand-alone container and checked how it can be used. There are however a few problems with
      this picture:<p>
    <ol>
      <li> Tomcat is not as fast as Apache when it comes to static pages. </li>
      <li> Tomcat is not as configurable as Apache. </li>
      <li> Tomcat is not as robust as Apache. </li>
      <li> There are many sites with long time investment in certain web servers,
	for example, sites that are using CGI scripts/Server API modules/perl/php...
	We cannot assume that all of them will want to ditch this legacy. </li>
    </ol>

    <p> For all these reasons it is recommended that real world sites will use a web server
      (such as Apache) for serving the static content of the site, and use Tomcat as a Servlet/JSP
      add-on. </p>

    <p> We are not going to cover the different configuration in depth, what we are going to
      do instead is:
    <ol>
      <li> Cover the fundamental behavior of the web server. </li>
      <li> Explain what configuration is needed. </li>
      <li> Demonstrate this on Apache. </li>
    </ol>

    <h3> Web Server Operation </h3>
    <p> In a nutshell a web server is waiting for client HTTP requests. When these requests
      arrive, the server do whatever needed to serve the requests by providing the needed
      content. Adding a servlet container to game somewhat change this behavior. Now the
      web server needs also to perform the following:
    <ul>
      <li> Load the servlet container adapter library and initialize it (prior
	to serving requests). </li>
      <li> When a request arrive, it need to check and see if a certain request belongs
	to a servlet and if so, it need to let the adapter to take the request and
	handle it.</li>
    </ul>

    The adapter on the other hand need to know what requests it is going to serve (usually based
    on some pattern in the request url) and to where to direct these requests.
  </p>

    <p>
      Things are more complex when you want to set a configuration that uses virtual hosts, or
      when you want multiple developers to work on the same web server but on different servlet
      container JVMs. We will cover these two cases.
    </p>

    <h3> What is the Needed Configuration </h3>
    <p> The most obvious configuration that one can think of is the identity of the servlet urls
      that are under the responsibility of the servlet container. This is clear; someone must
      know what requests to transmit to the servlet container...
      Yet there are additional configuration items that we should provide to
      the web-server/servlet-container combination:
    <ul>
      <li>We also need to provide configuration regarding the available Tomcat processes
	and on which TCP/IP host/port they are listening. </li>
      <li> We need to tell the web server the location of the adapter library (so it
	will be able to load it on startup). </li>
      <li> We need to set adapter internal information such as where and how much to log, etc. </li>
    </ul>
    All this information must appear either in the web server configuration, or in a private
    configuration files used by the adapter. The next section will demonstrate how configuration
    can be implemented on Apache.
  </p>


    <h3> Making it on Apache </h3>
    <p> This section shows how to configure Apache to work with Tomcat; it does not intend
      to replace the howto file that is provided as part of the Tomcat distribution. Instead
      it tries to provide a better insight of the configuration instructions. You can find
      additional information the <a href="in http://java.apache.org/jserv/install/index.html">
	jserv install page </a>.
    </p>

    <p> When Tomcat starts up it will automatically generate a configuration file for
        Apache in <code>TOMCAT_HOME/conf/tomcat-apache.conf</code> Most of the time you don't need to 
        do anything but include this file ( using Include ) in your httpd.conf.
        If you have special needs, you can use this file as a base for  your customized configuration.
    </p>

    <p> The Apache-Tomcat configuration uses Apache core configuration directives
      as well as Jserv unique directives so it may confuse you at first, there are
      however two things simplifying it:
    <ul>
      <li> In general you can distinguish between the two directive "families" by
	noting that all the Jserv unique directives starts with an "Ajp" prefix. </li>
      <li> The entire tomcat related configuration is concentrated in a single
	configuration file namely tomcat.conf (or the automatically generated
	tomcat-apache.conf) so you can look at a single file.</li>
      </ul>
    Lets look now at a sample tomcat.conf file.
    </p>
    
    <table> 
      <tr> 
	<td BGCOLOR="#c0c0c0"> 
	  <pre>    
###########################################################
#       A minimalistic Apache JServ Configuration File    #
###########################################################

# Note: this file should be appended or included into your httpd.conf

# (1) Loading the jserv module that serves as Tomcat's apache adapter.
LoadModule jserv_module libexec/mod_jserv.so

# (1a) Module dependent configuration.
&lt;IfModule mod_jserv.c&gt;

# (2) Meaning, Apache will not try to start Tomcat.
ApJServManual on
# (2a) Meaning, secure communication is off
ApJServSecretKey DISABLED
# (2b) Meaning, when virtual hosts are used, copy the mount
# points from the base server
ApJServMountCopy on
# (2c) Log level for the jserv module.
ApJServLogLevel notice

# (3) Meaning, the default communication protocol is ajp12
ApJServDefaultProtocol ajpv12
# (3a) Default location for the Tomcat connectors.
# Located on the same host and on port 8007
ApJServDefaultHost localhost
ApJServDefaultPort 8007

# (4)
ApJServMount /examples /root
# Full URL mount
# ApJServMount /examples ajp12://hostname:port/root
&lt;/IfModule&gt;
	  </pre> 
	</td> 
      </tr> 
    </table>

    <p>As you can see the configuration process was splitted into 4 steps
      that I am now going to explain:
      <ol>
      <li> In this step we instruct Apache to load the jserv shared-object (or the NT
	world dll). This is a well known Apache directive. If the loading whent well
	and the module came from a file named mod_jserv.c (1a) we will start with the
	rest of the Jserv-Tomcat configuration. </li>
      <li> This step set various Jserv internal parameters, these parameters:
	<ul>
	  <li> Instructs jserv not to start the Tomcat process.
	    Automatically starting Tomcat is not implemented yet.</il>
	  <li> Disable the secret key challenge/response between Apache and Tomcat.
	    Again, the secret key work is not implemented yet.</il
	  <li> Instructs jserv to copy the base server mount points (see next
	    section) in case of virtual hosting. </il>
	  <li> Instructs jserv to use the notice log level. Other log levels
	    includes emerg, alert, crit, error, warn, info and debug. </il>
	</ul>
      </li>
      <li> This step sets the default communication parameters. Basically is says
	that the default protocol used for the communication is ajp12 (do not mess
	with this one) and that the Tomcat process runs on the same machine and
	listens on port 8007. If you run Tomcat on a machine other the one used
	for Apache you should either update your ApJServDefaultHost or use a full
	URL when mounting contexts (see next). Also, if you configured the Tomcat
	connectors to use a port other then 8007, you should update your
	ApJServDefaultPort or use a full URL when mounting contexts. </li>
      <li> This step mounts a context to Tomcat. Basically it say that all the
	web server path that start with /examples goes to Tomcat.
	This ApJServMount example is a rather simple one, if fact ApJServMount
	can provide also information regarding the communication protocol to by
	used and the location where the Tomcat process listens, for example:
	<div><tt>ApJServMount /examples ajp12://hostname:port/root </tt></div>
	mounts the context /examples to a Tomcat process that runt on host 
	"hostname" and listens on port number "port". </li>
    </ol>
    Now that you understand the different configuration instructions in the sample
    file, how can you add it to the Apache configuration? One "simple" method is to 
    write it's content in the httpd.conf (the Apache configuration file), this however
    can be very messy. Instead you should use the Apache include directive. At the end 
    of the Apache configuration file (httpd.conf) add the following directive:
    <div> <tt>include &lt;full path to the Tomcat configuration file&gt; </tt></div>
    for example:
    <div> <tt>include /tome/tomcat/conf/tomcat.conf </tt></div>
    This will a your Tomcat configuration to Apache, after that you should copy
    the jserv module to the Apache libexec (or modules in the Win32 case) directory
    and restart (stop+start) Apache. It should now be able to connect to Tomcat.
    </p>

    <h3> Obtaining the Jserv Module (mod_jserv) </h3>
    <p> As previously stated, we need a web server adapter to sit in Apache and redirect
      requests to Tomcat. For Apache, this adapter is a slightly modified version of
      mod_jserv.
    </p>
    <p> You may try to look <a href="http://jakarta.apache.org/downloads/binindex.html">
      here </a> and see if there is an already pre-built version of mod_jserv that
      suites your OS (Usually there is one for NT), however, being a native library you
      should not expect that yet (too many OSs/not enougth developers/life too short...).
      Moreover, small variations in the way you built Apache/Your specific UNIX variant may
      result in dynamic linking errors. You should really try to build mod_jserv for your
      system (don't panic, it is not that hard!).
    </p>
    <p>
      Building mod_jserv on <b>UNIX</b> involves the following:
    <ol>
      <li> Download the source distribution of Tomcat from
	<a href="http://jakarta.apache.org/downloads/sourceindex.html"> here</a>. </li>
      <li> Uncompress it into some directory. </li>
      <li> Building the module:
	<ul>
	  <li> Change directory into jakarta-tomcat/src/native/apache/jserv/</li>
	  <li> Execute the build command <div><tt> apxs -c *.c -o mod_jserv.so </tt></div> 
	    apxs is part of the Apache distribution and should be located in your
	    APACHE_HOME/bin.</li>
	</ul>
      </li>
    </ol>  
    Building mod_jserv for <b>Win32</b> is less likely (you already have a downloadable dll
    for Win32). Yet if you <em>want</em> to build it you should install Visual C++ and 
    perform the following:
    <ol>
      <li> Download the source distribution of Tomcat from
	<a href="http://jakarta.apache.org/downloads/sourceindex.html"> here</a>. </li>
      <li> Unzip it into some directory. </li>
      <li> Building the module:
	<ul>
	  <li> Change directory into jakarta-tomcat\src\native\apache\jserv</li>
	  <li> Add  Visual C++ into your environment by executing the script
	    VCVARS32.BAT. </li>
	  <li> Execute the build command <div><tt> nmake -f Makefile.win32 </tt></div>
	    nmake is the Visual C++ make program.</li>
	</ul>
      </li>
    </ol>
    That's it; you have built mod_jserv...
    </p>
    <h3> Making Apache Serve your Contex's Static Files </h3>
    Blurb.
    <h3> Configuring for Multiple Tomcat JVMs </h3>
    Blurb.
    <h3> Configuring Virtual Hosting </h3>
    Blurb.

    <h2> Real World Configuration Tips </h2>
    Blurb.
    <h3> Modify and Customize the Batch Files </h3>
    Blurb.
    <h3> Start Tomcat from /etc/inittab </h3>
    Blurb.
    <h3> Modify the Default JVM Settings </h3>
    <p> The default JVM settings in the tomcat script are very naïve; 
        everything is left for defaults. There are few things that you 
	should consider to improve your Tomcat performance:
    <ol>
      <li> Modify your JVM memory configuration. Normally the JVM allocates an initial size
	for the Java heap and that's it. If you need more then this amount of memory you will
	not get it. Use command line parameters such as </li>
      <li> Modify your JVM threading configuration. </li>
    </ol>
  </p>


    <h2>Authors</h2>
    <p>
      This document was created by:
    <ul>
	<a href="mailto:shachor@il.ibm.com"> Gal Shachor</a>
    </ul>
  </p>

    <table width="100%" border="0" cellpadding="10" cellspacing="0">
      <tr>
	<td>
	  <p class="fineprint">
	    Copyright &copy;1999 The Apache Software Foundation<br>
	    <a href="http://jakarta.apache.org/legal.html">Legal Stuff They Make Us Say</a><br>
	    <a href="http://jakarta.apache.org/contact.html">Contact Information</a> </p>
	</td>
      </tr>
    </table>

  </body>
</html>
