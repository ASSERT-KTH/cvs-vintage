#macro ( attributeOptionOptionList $optionList $selectOptions )

#set ($showSeparator = false)
#foreach ( $option in $optionList )
    #if ($showSeparator && $option.isAttribute())
			    <option value="">----------------------------------</option>
    #end
    #set ($showSeparator = true)
    #if ($option.isAttribute())
        #set ($spaces = "")
    #else
        #set ($spaces = "&nbsp;&nbsp;&nbsp;")
    #end
    #set ($selected = "")
    #set ($quote = '"')
    #foreach ($value in $selectOptions )
        #if ($option.Value == $value)
            #set ($selected = ' selected="selected"')
        #end
    #end
    	    <option value="$option.Value"$selected>$spaces$option.Name</option>
#end

#end



#macro ( addReportHiddenInputs $report $template)

#set ( $ir = $intake.Report.mapTo($report) )
#if ($template != "reports,Step1.vm")
#if ($report.Name)
    <input type="hidden" name="$ir.Name.Key" value="$ir.Name" />
#end
#if ($report.Description)
    <input type="hidden" name="$ir.Description.Key" value="$ir.Description" />
#end
#if ($report.Type != 0)
    <input type="hidden" name="$ir.Type.Key" value="$ir.Type" />
#end
#end

#if ($template != "reports,Step2.vm")
#if ($report.AttributesAndOptionsForGrouping)
    #foreach ($ao in $report.AttributesAndOptionsForGrouping)
    <input type="hidden" name="$ir.AttributesAndOptionsForGrouping.Key" 
        value="$ao" />
    #end
#end
#end

#if ($template != "reports,Step2b.vm")
#if ($report.OptionGroups)
    #foreach ($group in $report.OptionGroups)
        #set ($intakeOptionGroup = $intake.OptionGroup.mapTo($group))
        <input type="hidden" name="$intakeOptionGroup.DisplayValue.Key" 
            value="$intakeOptionGroup.DisplayValue" />
        #if ($group.Options)
            #foreach ($option in $group.Options)
                <input type="hidden" name="ofg$option.QueryKey" 
                    value="$group.QueryKey" />        
            #end
        #end
    #end
#end
#end

#if ($template != "reports,Step3_1a.vm"  && $template != "reports,Step3_2a")
#if ($report.Axis1Category != 0)
    <input type="hidden" name="$ir.Axis1Category.Key" 
        value="$ir.Axis1Category" />
#end
#if ($report.Axis2Category != 0)
    <input type="hidden" name="$ir.Axis2Category.Key" 
        value="$ir.Axis2Category" />
#end
#end

#if ($template != "reports,Step3_1b.vm"  && $template != "reports,Step3_2b")
#if ($report.Axis1AttributesAndOptions)
    #foreach ($ao in $report.Axis1AttributesAndOptions)
    <input type="hidden" name="$ir.Axis1AttributesAndOptions.Key" 
        value="$ao" />
    #end
#end
#if ($report.Axis2AttributesAndOptions)
    #foreach ($ao in $report.Axis2AttributesAndOptions)
    <input type="hidden" name="$ir.Axis2AttributesAndOptions.Key" 
        value="$ao" />
    #end
#end
#end

#*
#if ($report.Dates)
    #foreach ($date in $report.Dates)
$date
        <input type="hidden" name="$ir.Dates.Key" 
            value="$format.getDate("MM/dd/yy HH:mm", $date)" />
    #end
#end
*#


#if ($template != "reports,Step3_1a.vm"  && $template != "reports,Step3_2b")
#if ($report.ReportDates)
    #foreach ($date in $report.ReportDates)
        #set ($intakeDate = $intake.ReportDate.mapTo($date))
        <input type="hidden" name="$intakeDate.Date.Key" 
            value="$format.getDate("MM/dd/yy HH:mm", $date.Date)" />
    #end
#end
#end

#end
