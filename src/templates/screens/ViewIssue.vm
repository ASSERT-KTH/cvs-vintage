<div class="app" id="viewissue">

#set ($currentIssueId = $data.Parameters.getString("id"))
#set ($currentIssue = $scarabR.getIssue($currentIssueId))

#if ($currentIssue.Module != $scarabR.CurrentModule)

<p class="alert">
You are viewing an issue in a different module ($currentIssue.Module.Name) than is currently selected.
</p>

#end

#printCollisionInfo()
#if ($currentIssue)

 #set ($issueList = $data.Parameters.getString("issueList", "false"))
 #set ($attrValues = $currentIssue.ModuleAttributeValuesMap)
 <form method="post" enctype="multipart/form-data" action="$link.setPage("ViewIssue.vm")">
   <input type="hidden" name="$scarabG.Constant.NEXT_TEMPLATE" value="ViewIssue.vm" />
   <input type="hidden" name="$scarabG.Constant.CANCEL_TEMPLATE" value="ViewIssue.vm" />

 #if ($fullHistory)
   <input type="hidden" name="fullHistory" value="$fullHistory" />
 #end

#if ($data.User.getTemp($scarabG.Constant.TAB_KEY))
    #set ($tab = $data.User.getTemp($scarabG.Constant.TAB_KEY))
#else
    #set ($tab = $data.Parameters.getString("tab","1"))
#end

#if ($tab.equals("all"))
    <div align="right"><small><a href="$link.setPage("ViewIssue.vm").addPathInfo("id", "$currentIssue.UniqueId").addPathInfo("tab", "1").addPathInfo("action", "ModifyIssue").addPathInfo("eventSubmit_doSetissueview", "foo")">View as tabs</a> 
      | <a href="$scarabR.getCopyableLink($currentIssue)">Copyable link</a></small></div>
    #if ($scarabR.CurrentQuery && $issueList.equals("true"))
        #navigate()
    #end
#elseif (!$multiple.equals("true"))
    <div align="right"><small><a href="$link.setPage("ViewIssue.vm").addPathInfo("id", "$currentIssue.UniqueId").addPathInfo("tab", "all").addPathInfo("action", "ModifyIssue").addPathInfo("eventSubmit_doSetissueview", "foo")">View as single screen</a>
      | <a href="$scarabR.getCopyableLink($currentIssue)">Copyable link</a></small></small></div>
    #if ($scarabR.CurrentQuery && $issueList.equals("true"))
        #navigate()
    #end

<div class="tabs">
<table cellpadding="3" cellspacing="0" border="0">
<tr>
#if ($tab.equals("1"))
<th>Attributes</th>
#else
<td><a href="$link.setPage("ViewIssue.vm").addPathInfo("id", "$currentIssue.UniqueId").addPathInfo("tab", "1").addPathInfo("action", "ModifyIssue").addPathInfo("eventSubmit_doSetissueview", "foo")">Attributes</a></td>
#end
#if ($tab.equals("2"))
<th>Personnel</th>
#else
<td><a href="$link.setPage("ViewIssue.vm").addPathInfo("id", "$currentIssue.UniqueId").addPathInfo("tab", "2").addPathInfo("action", "ModifyIssue").addPathInfo("eventSubmit_doSetissueview", "foo")">Personnel</a></td>
#end
#if ($tab.equals("3"))
<th>Comments</th>
#else
<td><a href="$link.setPage("ViewIssue.vm").addPathInfo("id", "$currentIssue.UniqueId").addPathInfo("tab", "3").addPathInfo("action", "ModifyIssue").addPathInfo("eventSubmit_doSetissueview", "foo")">Comments</a></td>
#end
#if ($tab.equals("4"))
<th>URLs/Attachments/Dependencies</th>
#else
<td><a href="$link.setPage("ViewIssue.vm").addPathInfo("id", "$currentIssue.UniqueId").addPathInfo("tab", "4").addPathInfo("action", "ModifyIssue").addPathInfo("eventSubmit_doSetissueview", "foo")">URLs/Attachments/Dependencies</a></td>
#end
#if ($tab.equals("5"))
<th>History</th>
#else
<td><a href="$link.setPage("ViewIssue.vm").addPathInfo("id", "$currentIssue.UniqueId").addPathInfo("tab", "5").addPathInfo("action", "ModifyIssue").addPathInfo("eventSubmit_doSetissueview", "foo")">History</a></td>
#end
</tr>
</table>
</div>
#end

#viewIssue($currentIssue)

 $intake.declareGroups()
 </form>

#else

<h3>Issue search results</h3>

  #if ($currentIssueId && $currentIssueId.length() > 0)
    <p class="alert">
    The issue id, $currentIssueId, is not valid. Please enter a new issue id.
    </p>
  #else
    <p class="alert">
    You need to enter an issue id.
    </p>
  #end

#end

</div>
