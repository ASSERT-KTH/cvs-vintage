$page.setTitle("Add/Remove Attributes From View")

#set ($action = $link.setPage("ConfigureIssueList.vm").setAction("ConfigureIssueList").addPathInfo("nextTemplate", "ConfigureIssueList.vm"))
#set ($user = $data.User)
#set ($module = $scarabR.CurrentModule)
#set ($moduleAttributes = $module.getRModuleAttributes(true))
#set ($maxNum = $moduleAttributes.size())

<form action="$action" method="post">
<input type="hidden" name="user_id" value="$user.UserId">
<input type="hidden" name="module_id" value="$module.ModuleId">

      <div class="app" id="div2-6-1">
      <h3>$page.Title</h3>

<p class="functnbar">
<input type="submit" value="save" name="eventSubmit_doSelectattributes" />&nbsp;
<input type="submit" value="cancel" name="eventSubmit_doCancel"/>&nbsp;
<input type="submit" value="reset to default"  name="eventSubmit_doCancel" />
</p>

      <h3>Attributes</h3>

       <table width="100%" border="1" cellspacing="2" cellpadding="3">
        <tr>
         <th>Select:</th>
         <th>Attribute Name:</th>
         <th>Columnar Sequence:</th>
        </tr>

#foreach ($moduleAttribute in $moduleAttributes)
    #set ($checked = "")
    #set ($attribute = $moduleAttribute.Attribute)
    #set ($userAttribute = $user.getModuleUserAttribute($module.ModuleId, $attribute.AttributeId))
    #set ($intakeUserAttr = $intake.RModuleUserAttribute.mapTo($userAttribute))

    #foreach ($moduleUserAttribute in $user.getRModuleUserAttributes($module))
       #if ($attribute.Name.equals($moduleUserAttribute.Attribute.Name))
          #set ($checked = "checked")
       #end
    #end
        <tr class="a">
         ##<td><input type="checkbox" name="$intakeUserAttr.Selected.Key" $checked /></td>
         <td><input type="checkbox" name="selected_$attribute.AttributeId" $checked /></td>

         <td>$attribute.Name</td>

         <td>
          #numericSelect ($intakeUserAttr.Order.Key 1 $maxNum $intakeUserAttr.Order.Value 1)
         </td>
        </tr>
    #end
      </table>

<p class="functnbar">
<input type="submit" value="save" name="eventSubmit_doSelectattributes"/>&nbsp;
<input type="submit" value="cancel" name="eventSubmit_doCancel"/>&nbsp;
<input type="submit" value="reset to default"  name="eventSubmit_doCancel"/>
</p>
        
     </div>
$intake.declareGroups()
  </form>
