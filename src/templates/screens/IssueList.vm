#set ( $action = $link.setPage("IssueList.vm").setAction("Search") )

#set ($user = $data.User)
#set ($module = $scarabR.CurrentModule)
#set ($search = $scarabR.Search)
#set ($searchGroup = $intake.SearchIssue.mapTo($search)) 
#set ($searchType = $data.Parameters.getString("searchType"))
#set ($resultsPerPage = $data.Parameters.getInt("resultsPerPage"))
#set ($pageNum = $data.Parameters.getInt("pageNum"))

#set( $issueList = $scarabR.IssueList )
#if ($issueList.size() > $resultsPerPage)
   #set ($paginated = "true")
   #set ($issueList = $scarabR.getPaginatedList($issueList, $pageNum, $resultsPerPage))
#end

	
<P>

<form name="IssueListForm" action="$action" method="post">
<input type="hidden" name="queryString" value="$queryString">
<input type="hidden" name="pageNum" value="$pageNum" /> 

## PAGINATION
#if( $paginated)
	<div class="misc">
  #if( $scarabR.PrevPage != 0 )
    #set ( $prevLink = $link.setPathInfo("resultsperpage", $resultsPerPage.toString()).setPathInfo("pageNum", $scarabR.PrevPage.toString()).setPage("IssueList.vm"))
    <a href="$prevLink">&laquo;</a> previous |
  #end
     $pageNum of $scarabR.NbrPages 
  #if( $scarabR.NextPage != 0)
    #set ( $nextLink = $link.setPathInfo("resultsperpage", $resultsPerPage.toString()).setPathInfo("pageNum", $scarabR.NextPage.toString()).setPage("IssueList.vm"))
    | <a href="$nextLink">&raquo;</a> next
  #end
    (<a href="ConfigureIssueList.vm">add/remove attributes from view</a>)</div>
#end



<p class="functnbar"><input type="submit" value="view selected (verbose)" name="eventSubmit_doViewselected" name="eventSubmit_doViewselected" />&#160;<input type="submit" value="view all (verbose)" name="eventSubmit_doViewall" /></p>

<p class="functnbar"><input type="submit" value="reassign selected" name="eventSubmit_doReassignselected" />&#160;<sup>|</sup>&#160;<input type="submit" value="reassign all" name="eventSubmit_doReassignall" />
#if ($searchType.equals("advanced"))
&#160;<sup>|</sup>
&#160;<input type="submit" value="save query" name="eventSubmit_doSavequery" />#end</p>
	

	<h3>Search Results</h3>

	<div class="datatable">
		<table width="100%" border="1" cellspacing="2" cellpadding="3">
		<tr>
		<th nowrap="nowrap"><a href="#"><img src="scarab/images/icon_uparrow.gif" width="13" height="8" alt="sort" border="0" /></a><a href="#"><img src="scarab/images/icon_downarrow.gif" width="13" height="8" alt="sort" border="0" /></a></th>
		<th><a href="#" class="header" title="sort">issue ID:</a></th>
#foreach( $userAttribute in $user.getAttributesForIssueList($module))
		<th><a href="#" class="header" title="sort">$userAttribute.Name:</a></th>
#end
		</tr>
		
#foreach ($issue in $issueList)

    #set ( $issueLink = $link.addPathInfo($data.Parameters).setPathInfo("id", $issue.IssueId.toString()).setPage("ViewIssue.vm").toString() )
         #if( $velocityCount % 2 > 0 )
            <tr class="a">
         #else 
            <tr class="b">
         #end
		<td><input type="checkbox" name="selected_$issue.IssueId" /></td>
		<td><a href="$issueLink">$issue.UniqueId</a></td>
#foreach( $userAttribute in $user.getAttributesForIssueList($module))
    <td>
       #set ($value = "" )
       #set ( $value = $issue.ModuleAttributeValuesMap.get($userAttribute.Name.toString().toUpperCase()).Value )
       #if ( !$value.equals("") )
         $value
       #else
         Not set
       #end
    </td>
#end
		</tr>
		
#end
		</table>
	</div>
	<div class="misc">issues per page:&#160; <input type="radio"  value="2" name="resultsPerPage" #if( $resultsPerPage == 2 ) checked="checked" #end /> 2 <input type="radio" " name="resultsPerPage" value="50" #if( $resultsPerPage == 50 ) checked="checked" #end /> 50 <input type="radio" name="resultsPerPage"  value="75" #if( $resultsPerPage == 75 ) checked="checked" #end /> 75 <input type="radio"  name="resultsPerPage" value="100" #if( $resultsPerPage == 100 ) checked="checked" #end /> 100&nbsp; <input type="submit" name="eventSubmit_doSearch" value="Refresh"></div>

<p class="functnbar"><input type="submit" value="view selected (verbose)" name="eventSubmit_doViewselected" name="eventSubmit_doViewselected" />&#160;<input type="submit" value="view all (verbose)" name="eventSubmit_doViewall" /></p>

<p class="functnbar"><input type="submit" value="reassign selected" name="eventSubmit_doReassignselected" />&#160;<sup>|</sup>&#160;<input type="submit" value="reassign all" name="eventSubmit_doReassignall" />
#if ($searchType.equals("advanced"))
&#160;<sup>|</sup>
&#160;<input type="submit" value="save query" name="eventSubmit_doSavequery" />#end</p>
	
	
#if( $paginated)
	<div class="misc">
  #if( $scarabR.PrevPage != 0 )
    #set ( $prevLink = $link.setPathInfo("resultsperpage", $resultsPerPage.toString()).setPathInfo("pageNum", $scarabR.PrevPage.toString()).setPage("IssueList.vm"))
    <a href="$prevLink">&laquo;</a> previous |
  #end
     $pageNum of $scarabR.NbrPages 
  #if( $scarabR.NextPage != 0)
    #set ( $nextLink = $link.setPathInfo("resultsperpage", $resultsPerPage.toString()).setPathInfo("pageNum", $scarabR.NextPage.toString()).setPage("IssueList.vm"))
    | <a href="$nextLink">&raquo;</a> next
  #end
    (<a href="ConfigureIssueList.vm">add/remove attributes from view</a>)</div>
#end
$intake.declareGroups()
</form>
