#set ($user = $scarabR.User)
#set ($module = $user.CurrentModule)

      <div class="app" id="CustomSearch.vm">
       <h2>custom search (2.2.0.x)</h2>
        (go to <a href="advancedsearch.html">advanced search</a>)

       <p>Lorem ipsum dolor sit amet, consectetuer adipiscing elit, sed diam nonummy nibh euismod tincidunt ut laoreet dolore magna aliquam erat volutpat. Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper suscipit lobortis nisl ut aliquip</p>

        <form action="$link.setPage("Search.vm")" method="get">
        <input type="hidden" name="nextTemplate" value="IssueList.vm" />
        <input type="hidden" name="action" value="Search" />

       <p class="functnbar">
        <input type="submit" name="eventSubmit_doSearch" 
            value="Search" />&#160;
        <input type="submit" name="eventSubmit_doCancel" 
            value="cancel" />
       </p>

#set ( $search = $scarabR.Search )
#set ( $searchGroup = $intake.SearchIssue.mapTo($search) )
#set ( $searchTextAttributes = $search.QuickSearchTextAttributes )
#set ( $searchValues = $search.QuickSearchOptionAttributeValues )

#if ($searchTextAttributes.size() != 0)

       <h3>text search</h3>

       <div class="axial">
        <table border="1" cellspacing="2" cellpadding="3">
         <tr>
          <th width="120">select text attributes:</th>
          <td>


    ## default to first attribute if none was selected previously
    #if ( $searchGroup.TextScope.isSet() )
        #set ($selectedIds = $searchGroup.TextScope.Value)
        #set ($selected = "")
    #else
        #set ($selected = " selected")
    #end


    <select name="$searchGroup.TextScope.Key" size="5" multiple>        

    #if ($searchTextAttributes.size() > 4)
        <option value="$search.ALL_TEXT"$selected>Search All</option>
        #set ($selected = "")
    #end

    #foreach ( $att in $searchTextAttributes )
        #if ($selectedIds)
            #foreach ( $id in $selectedIds )  
                #if ($id == $att.PrimaryKey)
                    #set ($selected = " selected")
                #end
            #end
        #end

        <option value="$att.QueryKey"$selected>$att.Name</option>

        #set ($selected = "")
    #end

    </select>
          </td>
         </tr>

         <tr>
          <th width="120">enter search string:</th>
          <td>

             <textarea name="$searchGroup.SearchWords.Key" 
                 rows="2" cols="30">$!searchGroup.SearchWords</textarea> 

          </td>
         </tr>
        </table>
       </div>
#end

       <h3>multiple / single choice search</h3>

       <div class="axial">
        <table width="100%" border="1" cellspacing="2" cellpadding="3">

#foreach ( $attVal in $searchValues )

     ##set ( $attrInput = $intake.AttributeValue.mapTo($attVal) ) 
     #if ( $attVal.Attribute.AttributeType.ValidationKey )
        #set ( $field = $attVal.Attribute.AttributeType.ValidationKey )
     #elseif ($attVal.Attribute.AttributeType.Name == "combo-box" )
        #set ( $field = "OptionId" )
     #end

         <tr>
          <th width="120">$attVal.Attribute.Name:</th>
          <td>

        #attrValueErrorMsg ( $attVal $field )
        #attrValueHierarchySelect ($attVal $field "")


          </td>
         </tr>

#end

        </table>
       </div>

<p>
issues per page: 
<input type="radio" name="$searchGroup.ResultsPerPage.Key" value="25" /> 25 
<input type="radio" name="$searchGroup.ResultsPerPage.Key" value="50" /> 50 
<input type="radio" name="$searchGroup.ResultsPerPage.Key" value="75" /> 75 
<input type="radio" name="$searchGroup.ResultsPerPage.Key" value="100" /> 100
</p>
       <p><a href="#">edit custom search - not implemented</a></p>

       <p class="functnbar">
        <input type="submit" name="eventSubmit_doSearch" 
            value="Search" />&#160;
        <input type="submit" name="eventSubmit_doCancel" 
            value="cancel" />
       </p>

        $intake.declareGroups()
        </form>

      </div>



#* old stuff 
                                      
    <TD WIDTH="36%">
        <TABLE BORDER="0" WIDTH="100%">

        <TR>
            <TD VALIGN="TOP" COLSPAN="2">My Saved Searches [M2]:</TD>
        </TR>

        <TR>
            <TD WIDTH="66%" VALIGN="TOP">
                <OL>           
                     <LI><A HREF="query.html">Search one</A>
                     <LI><A HREF="query.html">Search two</A>
                     <LI><A HREF="query.html">Search three</A>
                     <LI><A HREF="query.html">Add new</A>
               </OL>
            </TD>
                                                                
            <TD WIDTH="34%" VALIGN="TOP">
                <A HREF="query.html">edit</A> | 
                <A HREF="query.html">delete<BR>
                                     edit</A> | 
                <A HREF="query.html">delete<BR>
                                     edit</A> | 
                <A HREF="query.html">delete</A>
            </TD>
        </TR>
        </table>                     

    </td>
*#






