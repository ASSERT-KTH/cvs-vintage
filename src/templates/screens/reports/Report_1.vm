#set ($report = $scarabR.Report)

<div class="app" id="div2-4-1-a-output">

<form method="get" action="$link.setPage("Index.vm")">
<input type="hidden" name="action" value="GenerateReport" />

#set ($reports = $scarabR.CurrentModule.getSavedReports($data.User))
#if ($reports.size() > 0)
<h3>Saved reports</h3>
<select name="report_id">
    <option value="">Choose...</option>
    #foreach ($report in $reports)
        #set ($isSelected = $data.Parameters.getString("report_id") && $report.ReportId.equals($data.Parameters.getString("report_id"))) 
        <option value="$report.ReportId"
            #selected($isSelected)>$report.Name</option>
    #end
</select>
<input type="submit" value="Run" name="eventSubmit_doRunstoredreport"/>
<input type="submit" value="Edit" name="eventSubmit_doEditstoredreport"/>
#end

<h2>Generated Report</h2>

<h3>
#if ($report.Name)
$report.Name
#else
Report
#end
</h3>

<div>
 <strong>Module:</strong> $report.Module.Name
</div>
<div>
 <strong>Date Generated:</strong> $format.getNow("MM/dd/yyyy hh:mm a")
</div>
<div>
 <strong>Generated by:</strong> $report.GeneratedBy.FirstName $report.GeneratedBy.LastName
</div>

#if ($report.Description)
<div>
 <strong>Description:</strong> $report.Description
</div>
#end

#if ($report.Type == 0)
<div>
 <strong>Report Date/Time:</strong> $report.GeneratedDate
</div>
#end

<p>
#reportTable($report.Model $report.IssueType)
</p>

<div class="functnbar2">
<table cellpadding="4" cellspacing="0" border="1">
 <tr>
  <td class="firstchild">
    <input type="submit" value="Save this report" name="eventSubmit_doSavereport" />&#160;
<!--    <input type="submit" value="Print" name="eventSubmit_doPrint" />&#160; -->
    <input type="submit" value="Done" name="eventSubmit_doCancel" />
  </td>
 </tr>
</table>
</div>

#addReportHiddenInputs($report "reports,Report_1.vm")
$intake.declareGroups()
</form>
</div>
