$page.setTitle("Enter Issue")

#set ($issue = $scarabR.ReportingIssue)
#set ($action = $link.setPage("entry,Wizard3.vm").setAction("ReportIssue"))
#set ($attrValues = $issue.ModuleAttributeValuesMap)

<div class="app" id="wizard3">
<form method="get" action="$action">

<h3>Input your issue</h3>
	
<div class="axial">
    <table cellpadding="3" cellspacing="2" border="0">

#foreach ( $attKey in $attrValues.sequence() )
  #set ( $attVal = $attrValues.get($attKey) )
  #set ( $attrInput = $intake.AttributeValue.mapTo($attVal) ) 

  #if ( $attVal.Attribute.AttributeType.ValidationKey )
        #set ( $field = $attVal.Attribute.AttributeType.ValidationKey )
  #elseif ($attVal.Attribute.AttributeType.Name == "combo-box" )
        #set ( $field = "OptionId" )
  #else
        #set ( $field = "Value" )  
  #end

  #if ( !$attVal.isSet() )

        <tr>
            <th>
    #if ( $attVal.isRequired() )*#end
    $attVal.Attribute.Name:
    #attrValueErrorMsg ( $attVal $field )<br />
            </th>
            <td>

    #if ($attVal.Attribute.AttributeType.AttributeClass.Name == "user")
          #userSelectBox ($attVal "")
    #elseif ($attVal.Attribute.AttributeType.Name == "combo-box" )
          #attrValueLeafSelect ($attVal $field "")
    #else

        #if ($attVal.Attribute.AttributeType.Name == "long-string" )
            <textarea name= "$attrInput.Value.Key" class="text" cols="40"
               rows="4">$!attrInput.Value</textarea>
        #else
           <input name= "$attrInput.Value.Key"
                value="$!attrInput.Value" size="45" type="text" class="text" />
        #end
    #end
            </td>
        </tr>
  #end
#end

        </table>
</div>

<h3>Add Attachment</h3>

<div class="axial">
    <table cellpadding="3" cellspacing="2" border="0">
     <tr>
      <th>Attachment Description</th>

#set ( $atch = $scarabR.Attachment )
#set( $intakeAttachment = $intake.Attachment.mapTo($atch) )

      <td>
       <textarea name="$intakeAttachment.Name.Key" cols="45" rows="2" 
            class="text">$!intakeAttachment.Name</textarea>
        <p>
          Please provide a short (less than 250 characters) description 
          of the attachment
        </p>
      </td>
     </tr>

     <tr>
      <th>File path</th>

      <td>
       <input type="file" name="$intakeAttachment.File.Key" size="45" 
            class="text" value="$!intakeAttachment.File.Value.FileName"/>

       <p>Click Browse and select a file. If you do not see a Browse
       button, your browser does not support file uploads. Windows
       users, set Files of Type: to be All Files (*.*) to get a
       complete file listing. The File field cannot be used to
       rename files.</p>

      </td>
     </tr>
    </table>
</div>

<br/>

<div class="axial">
    <table cellpadding="3" cellspacing="2" border="0">
     <tr>
     <th>
      workflow options</th>
     <td>
    return to&#160;
   <input type="radio" name="nextTemplate" 
      value="$data.Parameters.getString($scarabG.Constant.HISTORY_SCREEN, "entry,Wizard3.vm")"/> 
      Enter New Issue 
  <input type="radio" name="nextTemplate" value="Index.vm" /> 
      Start Page 
  <input type="radio" name="nextTemplate" value="AssignIssue.vm"/> 
      Assign Issue
      </td>
      </tr>
    </table>
</div>

<p class="functnbar">
<input type="submit" name="eventSubmit_doEnterissue" value="Save Issue"/>&#160;
<input type="reset" value="Reset"/>
</p>

$intake.declareGroups()
</form>
</div>
