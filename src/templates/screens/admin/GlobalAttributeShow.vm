<div id="globalattributeshow" class="app">

<p>
This page is for selecting an Attribute to edit which is defined in a global scale.
</p>

## SORTING

#set ($sortColumn = $data.Parameters.getString("sortColumn",""))
#set ($sortPolarity = $data.Parameters.getString("sortPolarity",""))
#if (!$sortColumn || $sortColumn.length() == 0)
   #set ($sortColumn = "name")
#end

#if (!$sortPolarity || $sortPolarity.length() == 0)
   #set ($sortPolarity = "asc")
#end

#set ($allAttributes = $scarabG.getAllAttributes($sortColumn, $sortPolarity))

## PAGINATION
## if results exceed limit, get subset list
#set ($resultsPerPage = $data.Parameters.getInt("resultsPerPage",0))
#set ($pageNum = $data.Parameters.getInt("pageNum",0))

#if ($resultsPerPage == 0)
  #set ($resultsPerPage = 25)
#end

#if ($pageNum == 0)
  #set ($pageNum = 1)
#end

#if ($allAttributes.size() > $resultsPerPage)
 #set ($paginated = "true")
 #set ($pagList = $scarabR.getPaginatedList($allAttributes, $pageNum.toString(), $resultsPerPage.toString()))

 #if ($pagList)
   #set ($allAttributes = $pagList)
 #end
#end

## INPUT FORM

<form action="$link.setPage("admin,GlobalAttributeShow.vm")" method="post">
<input type="hidden" name="action" value="admin.GlobalAttributes" />
<input type="hidden" name="$scarabG.Constant.OTHER_TEMPLATE" value="admin,GlobalAttributeEdit.vm" />
<input type="hidden" name="$scarabG.Constant.CANCEL_TEMPLATE" value="admin,GlobalAttributeShow.vm" />

<div class="tabs">
<table cellpadding="3" cellspacing="0" border="0">
<tr>
<th>
Global attributes
</th>

<td><a href="$link.setPage("admin,GlobalUserAttributes.vm")">User attributes</a></td>

</tr>
</table>
</div>

#if ($paginated)
  #paginate ($resultsPerPage $pageNum $sortColumn $sortPolarity)
#end

<h3>Global Attributes</h3>

#if ($allAttributes.isEmpty())
<p class="alert">Click the Create new button to create a new global attribute.</p>
#else
<table width="100%" border="1" cellspacing="2" cellpadding="3">
<tr>
<th>Select</th>
<th>#sort ("name" "Name")</th>
<th>#sort ("desc" "Description")</th>
<th>#sort("type" "Input type")</th>
<th>#sort ("user" "Author")</th>
<th>#sort("date" "Creation date")</th>
<th>Deleted?</th>
</tr>

#foreach( $attribute in $allAttributes )
  #if (!$attribute.isUserAttribute()) 
    #set ($attgroup = $intake.Attribute.mapTo($attribute))
    #indexedRows($velocityCount)
    #set ($attType = $attribute.AttributeType)

  <td><input type="checkbox" name="action_$attribute.AttributeId"></td>
  #if ($attribute.Deleted)
  <td><strike>$link.setPage("admin,GlobalAttributeEdit.vm").addPathInfo("att_0id", "$attgroup.Id").setLabel("$attribute.Name")</strike></td>
  <td><strike>#if ($attribute.Description) $attribute.Description #else &nbsp; #end</strike></td>
  <td>
    #foreach ( $atype in $attribute.AllAttributeTypes )
      #if ($attType.AttributeTypeId == $atype.AttributeTypeId)
        <strike>$atype.Name</strike>
      #end
    #end
  </td>
  <td><strike>#attributeCreatedBy($attribute)</strike></td>
  <td><strike>$format.getDate($scarabR.DateFormat, $attribute.CreatedDate)</strike></td>
  #else
  <td>$link.setPage("admin,GlobalAttributeEdit.vm").addPathInfo("att_0id", "$attgroup.Id").setLabel("$attribute.Name")</td>
  <td>#if ($attribute.Description) $attribute.Description #else &nbsp; #end</td>
  <td>
    ## Input type
    #set ($attType = $attribute.AttributeType)
    #foreach ( $atype in $attribute.AllAttributeTypes )
      #if ($attType.AttributeTypeId == $atype.AttributeTypeId)
        $atype.Name
      #end
    #end
  </td>
  <td>#attributeCreatedBy($attribute)</td>
  <td>$format.getDate($scarabR.DateFormat, $attribute.CreatedDate)</td>
#end
  <td>$attgroup.Deleted</td>
  </tr>
  #end
#end
</table>
#end

<div class="functnbar3">
<input type="submit" value="Create new"  name="eventSubmit_doCreatenew" />&#160;
#if (!$allAttributes.isEmpty())
<input type="submit" value="Copy selected" name="eventSubmit_doCopy" />&#160;
#end
</div>

#if ($paginated)
  #paginate ($resultsPerPage $pageNum $sortColumn $sortPolarity)
#end

$intake.declareGroups()

</form>
</div>
