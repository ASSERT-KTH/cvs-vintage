#set ($userModules = $data.User.Modules)
#set ($currentModule = $scarabR.CurrentModule)
<div id="selectmodule" class="app">

#if ($currentModule)
<h3>Current module</h3>
<table cellpadding="3" cellspacing="2" border="1" width="100%">
<tr>
    <th>Current module name</th>
    <th>Current module desc</th>
</tr>
<tr>
    <td>
    $currentModule.Name
    #set ($canEdit = $security.hasPermission("Module | Edit", $currentModule))
    #if ($canEdit)<a href="$link.setPage("ModifyModule.vm")">(Edit)</a>#end
    </td>
    <td>$currentModule.Description</td>
</tr>
</table>
#end

<h3>New module selection</h3>
#if ($userModules.size() > 0)
<table border="1" cellspacing="2" cellpadding="3" width="100%">
<tr>
    <th>Module name</th>
    <th>Module desc</th>
</tr>

#if ($nextTemplate && $nextTemplate.length() > 0)
#set ($tmpNext = $nextTemplate)
#else
#set ($tmpNext = "Links.vm")
#end

#foreach ($module in $userModules)
#indexedRows($velocityCount)
<td>
<a href="$link.setPage("SelectModule.vm").setAction("SelectModule").addPathInfo($scarabG.Constant.NEXT_TEMPLATE, "$tmpNext").addPathInfo("newmodule", "$module.ModuleId")">$module.Name</a>
</td>
<td>
$module.Description
</td>
</tr>
#end

</table>

#else
<p><strong class="alert">
Sorry, you do not have access to select any other modules. Please
<a href="$link.setPage("Login.vm").addPathInfo($scarabG.Constant.NEXT_TEMPLATE, "SelectModule.vm")">Login</a> with an account that
has permissions to select a Module.
</strong></p>
#end

</div>
