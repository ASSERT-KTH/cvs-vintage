<div id="changepassword" class="app">

<h2>$page.Title</h2>

#set ($regGroup = $intake.Register.Default)
#if ($regGroup.Email.Value && $regGroup.Email.Value.length() > 0)
  #set ($emailValue = $regGroup.Email.Value)
#else
  #if ($intake.Login.Default.Username.Value && $intake.Login.Default.Username.Value.length() > 0)
    #set ($emailValue = $intake.Login.Default.Username.value)
  #else
    #set ($emailValue = $data.User.Email)
  #end
#end

<h3>Change password</h3>

<form action="$link.setPage("ChangePassword.vm")" method="post">
 <input type="hidden" name="action" value="ChangePassword" />
 <input type="hidden" name="$scarabG.Constant.NEXT_TEMPLATE" value="Index.vm" />
 
<div class="axial">
<table cellpadding="3" cellspacing="2" border="0">
 <tr>
  <th>Email address</th>
  <td>
   <input type="text" size="25" name="$regGroup.Email.Key" value="$!emailValue" />
   #fieldErrorMsg($regGroup.Email "")
  </td>
 </tr>
 <tr>
  <th>Old password</th>
  <td>
   <input type="password" size="25" name="$regGroup.OldPassword.Key" value="$!regGroup.OldPassword.value" />
   #fieldErrorMsg($regGroup.OldPassword "")
  </td>
 </tr>
 <tr>
  <th>New password</th>
  <td>
   <input type="password" size="25" name="$regGroup.Password.Key" value="$!regGroup.Password.value" />
   #fieldErrorMsg($regGroup.Password "")
  </td>
 </tr>
 <tr>
  <th>Password confirm</th>
  <td>
   <input type="password" size="25" name="$regGroup.PasswordConfirm.Key" value="$!regGroup.PasswordConfirm.value" />
   #fieldErrorMsg($regGroup.PasswordConfirm "")
  </td>
 </tr>
</table>
</div>

<div class="functnbar2">
   <input type="submit" name="eventSubmit_doChangepassword" value="Change password" />&#160;
</div>

$intake.declareGroups()
</form>
</div>
