<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Author" content="IBM">
   <title>JDT/Core Breaking API changes</title>

</head>
<body>

<body text="#000000" bgcolor="#FFFFFF">
&nbsp;

<table border=0 cellspacing=5 cellpadding=2 width="100%" >
  <tr> 
    <td align=left width="72%">
      <font face="Verdana, Arial, Helvetica" size="+3"><b>jdt core - Breaking API changes from R2.1 to R3.0</b></font>
      <br><font face="Arial, Helvetica, sans-serif" size="-2" color="#8080ff">java development tooling core</font></td>
  </tr>
	<tr><td>&nbsp;</td></tr>
  <tr>
  	<td>
	  <font face="Arial, Helvetica, sans-serif" size="-1">
	  This document lists the breaking API changes that occured between R2.1 and R3.0 and how to migrate from the R2.1 API to
	  the R3.0 API.
	  </font>
	</td>
  </tr>
</table>

<p>
<ul>
<li>(in progress) <code>IWorkingCopy</code> now extends <code>ICompilationUnit</code>
	 (see <a href="http://bugs.eclipse.org/bugs/show_bug.cgi?id=36987 ">bug 36987 </a>)
	  <p>
	  Historically, <code>IWorkingCopy</code> gathered all working copy concerns, 
	  and <code>ICompilationUnit</code> implement this interface, though only the 
	  factory method makes sense for them; thus their implementation of the working 
	  copy features do nothing relevant to clients. <code>IWorkingCopy</code> also 
	  implements the spec'ed factory method, but it doesn't work for these.
	  </p>
	  <p>
	  Clients using <code>IWorkingCopy</code> and <code>ICompilationUnit</code> can
	  adapt to this change by referencing <code>IWorkingCopy</code> instead of 
	  <code>ICompilationUnit</code> when a working copy is needed.
	  </p>
</li>
<li>(in progress) Factory methods that create <code>IWorkingCopies</code> (i.e. 
	  <code>getWorkingCopy</code> and <code>getSharedWorkingCopy</code>) now return
	  an <code>IWorkingCopy</code> instead of an <code>IJavaElement</code>.
	  <p>
	  Working copies were initialy designed to be editable elements on any <code>IJavaElement</code>.
	  Pratice showed that they were used only to edit <code>ICompilationUnit</code>. To avoid 
	  downcasting to <code>IWorkingCopy</code>, the factory methods now return an
	  <code>IWorkingCopy</code>.
	  </p>
	  <p>
	  Clients using factory methods to create working copies can now remove the cast from 
	  <code>IJavaElement</code> to <code>IWorkingCopy</code>.
	  </p>
</li>

<li>2003/06/11 (->M2)
<code>CharOperation.patchMatch(...)</code> no longer treat non absolute pattern <code>'foo'</code>
as <code>'**/foo'</code> for free. This was inconsistent with Ant patternset rules. This has no incidence on
source folder exclusion patterns which are implicitely concatenating exclusion patterns to source folder
paths when using them. Only direct clients to this <code>CharOperation</code> API will be affected.
</li>

<li>2003/06/11 (->M2)
Change in syntax error message ID. The new diagnose of syntax errors use new error messages.
	  <p>
		The following messages ID are added:
		<ul>
			<li>IProblem.ParsingErrorInsertTokenBefore</li>
			<li>IProblem.ParsingErrorInsertTokenAfter</li>
			<li>IProblem.ParsingErrorDeleteToken</li>
			<li>IProblem.ParsingErrorDeleteTokens</li>
			<li>IProblem.ParsingErrorMergeTokens</li>
			<li>IProblem.ParsingErrorInvalidToken</li>
			<li>IProblem.ParsingErrorMisplacedConstruct</li>
			<li>IProblem.ParsingErrorReplaceTokens</li>
			<li>IProblem.ParsingErrorNoSuggestionForTokens</li>
			<li>IProblem.ParsingErrorUnexpectedEOF</li>
			<li>IProblem.ParsingErrorInsertToComplete</li>
			<li>IProblem.ParsingErrorInsertToCompleteScope</li>
			<li>IProblem.ParsingErrorInsertToCompletePhrase</li>
		</ul>
	  </p>
	  <p>
		The following messages ID are removed:
		<ul>
			<li>IProblem.ParsingErrorNoSuggestion</li>
			<li>IProblem.ParsingErrorOnKeyword</li>
			<li>IProblem.ParsingErrorOnKeywordNoSuggestion</li>
			<li>IProblem.UnmatchedBracket</li>
			<li>IProblem.InvalidExpressionAsStatement</li>
		</ul>
	  </p>
</li>
<li>2003/06/12 (->M2)
Added API <code>IJavaProject#forceClasspathReload(IProgressMonitor)</code> to force reload of <code>.classpath</code> file
before next automatic update occurs.
<pre>
/**
 * Force the project to reload its <code>.classpath</code> file from disk and update the classpath accordingly.
 * Usually, a change to the <code>.classpath</code> file is automatically noticed and reconciled at the next 
 * resource change notification event. If required to consider such a change prior to the next automatic
 * refresh, then this functionnality should be used to trigger a refresh. In particular, if a change to the file is performed,
 * during an operation where this change needs to be reflected before the operation ends, then an explicit refresh is
 * necessary.
 * 
 * @param monitor a progress monitor for reporting operation progress
 * @exception JavaModelException if the classpath could not be updated. Reasons
 * include:
 *  - This Java element does not exist (ELEMENT_DOES_NOT_EXIST)</li>
 *  - Two or more entries specify source roots with the same or overlapping paths (NAME_COLLISION)
 *  - A entry of kind <code>CPE_PROJECT</code> refers to this project (INVALID_PATH)
 *  - This Java element does not exist (ELEMENT_DOES_NOT_EXIST)</li>
 *  - The output location path refers to a location not contained in this project (<code>PATH_OUTSIDE_PROJECT</code>)
 *  - The output location path is not an absolute path (<code>RELATIVE_PATH</code>)
 *  - The output location path is nested inside a package fragment root of this project (<code>INVALID_PATH</code>)
 *  - The classpath is being modified during resource change event notification (CORE_EXCEPTION)
 * @since 3.0
 */
</pre>
</li>

</ul>
</body>
</html>
