<?xml version="1.0" encoding="ISO-8859-1"?>
<document url="./resources.xml">
<properties>
  <author>David Winterfeldt</author> 
  <author>James Turner</author> 
  <author>Rob Leland</author> 
<title>The Struts User's Guide - Validator Guide</title>
</properties>
<body> 
<chapter name="Struts Validator Guide"> 

<section href="validator" name="Struts Validator">

[:TODO:]
<p>Cover basic functionality as documented on David's web site.
<a href="http://home.earthlink.net/~dwinterfeldt/">Validation Framework for Struts </a> 
</p>

<p> Struts 1.1 has added additional functionality over the original validator
contributed by David Winterfeldt</p>
<ul>
<li> Conditionally required fields</li>
<li> intRange() &amp; floatRange() methods in both JavaScript and Java</li>
<li> Do <strong>not</strong> use the &lt;script/&gt; to include static java script
as in the old validator example.
 </li>
<li> deprecation of range() methods in both JavaScript and Java</li>
<li> deprecation of StrutsVlaidator &amp; StrutsValidatorUtil</li>
</ul>

<p>
The most fundamental change is the ability to conditionally
require validator fields based on the value of other fields.
It allows you to define logic like "only validate this field if field X is non-
null and field Y equals "male".</p>
<p>
The syntax looks like this:
</p>
<p>
If you have this in your struts-config.xml </p>
<ol>
<pre>        &lt;form-bean name="dependentlistForm" </pre>
<pre>           type="org.apache.struts.webapp.validator.forms.ValidatorForm"&gt; </pre>
<pre>           &lt;form-property name="dependents" </pre>
<pre>           type="org.apache.struts.webapp.validator.Dependent[]"</pre>
<pre>           initial="{'','','','','','','','','','',''}"/&gt;</pre>
<pre>           &lt;form-property name="insureDependents" type="java.lang.Boolean" </pre>
<pre>           initial="false"/&gt;</pre>
<pre>        &lt;/form-bean&gt;</pre>
</ol>
<p>
Where dependent is a bean that has properties lastName, firstName, dob, 
coverageType </p>
<p>
You can define a validation:</p>

<pre>  &lt;form name="dependentlistForm"&gt;</pre>
<pre>    &lt;field property="firstName" indexedListProperty="dependents" </pre>
<pre>           depends="requiredif"&gt;</pre>
<pre>      &lt;arg0 key="dependentlistForm.firstName.label"/&gt;</pre>
<pre>       &lt;var&gt;  &lt;var-name&gt;field[0]&lt;/var-name&gt;</pre>
<pre>              &lt;var-value&gt;lastName&lt;/var-value&gt;  &lt;/var&gt;</pre>
<pre>       &lt;var&gt;  &lt;var-name&gt;field-indexed[0]&lt;/var-name&gt;</pre>         
<pre>              &lt;var-value&gt;true&lt;/var-value&gt;            &lt;/var&gt;</pre>
<pre>       &lt;var&gt;  &lt;var-name&gt;field-test[0]&lt;/var-name&gt;</pre>                 
<pre>              &lt;var-value&gt;NOTNULL&lt;/var-value&gt; &lt;/var&gt;</pre>
<pre>     &lt;/field&gt;</pre>
<pre>    &lt;field property="dob" indexedListProperty="dependents" </pre>
<pre>           depends="requiredif,date"&gt;</pre>
<pre>      &lt;arg0 key="dependentlistForm.dob.label"/&gt;</pre>
<pre>      &lt;var&gt;   &lt;var-name&gt;field[0]&lt;/var-name&gt; </pre>
<pre>              &lt;var-value&gt;lastName&lt;/var-value&gt;  &lt;/var&gt;</pre>
<pre>       &lt;var&gt;  &lt;var-name&gt;field-indexed[0]&lt;/var-name&gt;  </pre>        
<pre>              &lt;var-value&gt;true&lt;/var-value&gt;            &lt;/var&gt;</pre>
<pre>      &lt;var&gt;   &lt;var-name&gt;field-test[0]&lt;/var-name&gt;   </pre>               
<pre>              &lt;var-value&gt;NOTNULL&lt;/var-value&gt;&lt;/var&gt;</pre>
<pre>     &lt;/field&gt;</pre>

<pre>    &lt;field property="coverageType" indexedListProperty="dependents"</pre> 
<pre>           depends="requiredif"&gt;</pre>
<pre>      &lt;arg0 key="dependentlistForm.coverageType.label"/&gt;</pre>
<pre>      &lt;var&gt;   &lt;var-name&gt;field[0]&lt;/var-name&gt;</pre>                        
<pre>              &lt;var-value&gt;lastName&lt;/var-value&gt;    &lt;/var&gt;</pre>
<pre>       &lt;var&gt;  &lt;var-name&gt;field-indexed[0]&lt;/var-name&gt;</pre>          
<pre>              &lt;var-value&gt;true&lt;/var-value&gt;             &lt;/var&gt;</pre>
<pre>      &lt;var&gt;   &lt;var-name&gt;field-test[0]&lt;/var-name&gt;</pre>                 
<pre>              &lt;var-value&gt;NOTNULL&lt;/var-value&gt;  &lt;/var&gt;</pre>
<pre>      &lt;var&gt;   &lt;var-name&gt;field[1]&lt;/var-name&gt;</pre>                        
<pre>              &lt;var-value&gt;insureDependents&lt;/var-value&gt;    &lt;/var&gt;</pre>
<pre>     &lt;var&gt;   &lt;var-name&gt;field-test[1]&lt;/var-name&gt; </pre>                
<pre>             &lt;var-value&gt;EQUAL&lt;/var-value&gt;        &lt;/var&gt;</pre>
<pre>     &lt;var&gt;   &lt;var-name&gt;field-value[1]&lt;/var-name&gt;</pre>               
<pre>             &lt;var-value&gt;true&lt;/var-value&gt;              &lt;/var&gt;</pre>
<pre>     &lt;var&gt;   &lt;var-name&gt;field-join&lt;/var-name&gt;          </pre>            
<pre>             &lt;var-value&gt;AND&lt;/var-value&gt;              &lt;/var&gt;</pre>
<pre>     &lt;/field&gt;</pre>
<pre>  &lt;/form&gt;</pre>
<p>
Which is read as follows:
The firstName field is only required if the lastName field is non-null.  Since 
field-indexed is true, it means that lastName must be a property of the same 
indexed field as firstName.  Same thing for dob, except that we validate for 
date if not blank.
</p>
<p>
The coverageType is only required if the lastName for the same indexed bean is 
not null, and also if the non-indexed field insureDependents is true.
</p>
<p>
You can have an arbitrary number of fields by using the [n] syntax, the only 
restriction is that they must all be AND or OR, you can't mix.
</p>




</section>

<section href="tiles" name="Validator API Guide">

<p>
A concise 
<a href="http://jakarta.apache.org/struts/api/org/apache/struts/validator/package-summary.html#package_description">Struts Validator API Guide</a> is available to help you get started. 
</p>

</section>

<!-- 
  <author>Ted Husted</author> 
<section href="resources" name="Validator Resources">
<p><b><u>Validating Input</u></b> by David Winterfeldt and Ted Husted. 
Sample chapter from <u>Java Web Development with Struts</u>; available as a 
<u>free download</u> (PDF).
</p>
</section>
-->

</chapter></body></document>
